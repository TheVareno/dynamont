```bash
g++ -g -O3 -Wall -o segmentation_3d_sparsed segmentation_3d_sparsed.cpp utils.cpp
g++ -g -O3 -Wall -o segmentation_basic_sparsed segmentation_basic_sparsed.cpp utils.cpp
g++ -g -O3 -Wall -o segmentation_indel segmentation_indel_.cpp utils.cpp
```

# Sparify Threshold
## 0.9
```
T: 11107, N: 439, K: 3125, inputsize: 15237415625
TN dense: 0.00315711346227717012
TK dense: 0.02251069055550553727                
dense: 0.00007141946028003026 (1088248), sparse: 0.99992858053972000221 (15236327377)
```

```
T: 41924, N: 147, K: 3125, inputsize: 19258837500
TN dense: 0.01283745059897826134
TK dense: 0.01863622173456731118
dense: 0.00016284420074680000 (3136190), sparse: 0.99983715579925325212 (19255701310)
```

### before training
T: 7945, N: 261, K: 3125, inputsize: 6480140625
dense: 0.00010700986909524051 (693439), sparse: 0.99989299013090471302 (6479447186)
T: 20267, N: 443, K: 3125, inputsize: 28057128125
dense: 0.00004898658885815670 (1374423), sparse: 0.99995101341114189797 (28055753702)
T: 49616, N: 1408, K: 3125, inputsize: 218310400000
dense: 0.00001976420271320102 (4314731), sparse: 0.99998023579728678722 (218306085269)
T: 72848, N: 1736, K: 3125, inputsize: 395200400000
dense: 0.00001564966533434683 (6184754), sparse: 0.99998435033466570587 (395194215246)

#### after training
Zs: [-29991.6, -6420.53, -67530.9, -59819.5]
T: 7945, N: 261, K: 3125, inputsize: 6480140625
dense: 0.00006100114532622507 (395296), sparse: 0.99993899885467374400 (6479745329)
T: 20267, N: 443, K: 3125, inputsize: 28057128125
dense: 0.00003224478271508767 (904696), sparse: 0.99996775521728487046 (28056223429)
T: 49616, N: 1408, K: 3125, inputsize: 218310400000
dense: 0.00001325692683445223 (2894125), sparse: 0.99998674307316559595 (218307505875)
T: 72848, N: 1736, K: 3125, inputsize: 395200400000
dense: 0.00001069561164411777 (4226910), sparse: 0.99998930438835587076 (395196173090)
Z changes: [3651.0999999999985, 1797.3899999999994, 3847.4999999999927, 15592.199999999997]

## 0.75
- ! sometime -inf, increased to 0.85

T: 7945, N: 261, K: 3125, inputsize: 6480140625
dense: 0.00005906029238370117 (382719), sparse: 0.99994093970761632750 (6479757906)
T: 20267, N: 443, K: 3125, inputsize: 28057128125
dense: 0.00002788111443604850 (782264), sparse: 0.99997211888556392090 (28056345861)
T: 49616, N: 1408, K: 3125, inputsize: 218310400000
dense: 0.00001140084027146668 (2488922), sparse: 0.99998859915972848622 (218307911078)
T: 72848, N: 1736, K: 3125, inputsize: 395200400000
dense: 0.00000891014533386100 (3521293), sparse: 0.99999108985466611532 (395196878707)

## 0.85
- after 500 reads, one had a -inf value

T: 7945, N: 261, K: 3125, inputsize: 6480140625
dense: 0.00008467609450990888 (548713), sparse: 0.99991532390549009435 (6479591912)
    dense: 0.00004475350409544546 (290009)
T: 20267, N: 443, K: 3125, inputsize: 28057128125
dense: 0.00003933417543959696 (1103604), sparse: 0.99996066582456044625 (28056024521)
T: 49616, N: 1408, K: 3125, inputsize: 218310400000
dense: 0.00001593433478203512 (3478631), sparse: 0.99998406566521791383 (218306921369)
T: 72848, N: 1736, K: 3125, inputsize: 395200400000
dense: 0.00001257807431368997 (4970860), sparse: 0.99998742192568634835 (395195429140)